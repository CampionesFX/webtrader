{"version":3,"sources":["../../../../src/financialassessment/financialassessment.es6"],"names":["win","win_view","events","on","data","is_mf","test","local_storage","get","id","send","get_account_status","then","risk","risk_classification","get_financial_assessment","Object","keys","length","init","createBlankWindow","i18n","title","width","height","resizable","collapsable","minimizable","maximizable","closable","closeOnEscape","modal","ignoreTileAction","close","unbind","dialog","state","financial","experience_array","frequency_array","forex_trading_experience","forex_trading_frequency","indices_trading_experience","indices_trading_frequency","commodities_trading_experience","commodities_trading_frequency","stocks_trading_experience","stocks_trading_frequency","other_derivatives_trading_experience","other_derivatives_trading_frequency","other_instruments_trading_experience","other_instruments_trading_frequency","employment_industry_array","employment_industry","education_level_array","education_level","income_source_array","income_source","net_income_array","net_income","estimated_worth_array","estimated_worth","occupation_array","occupation","disabled","empty_field","validate","submit","request","set_financial_assessment","catch","err","console","error","bind","moveToTop"],"mappings":"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","file":"financialassessment.js","sourcesContent":["import rv from 'common/rivetsExtra';\nimport $html from 'text!./financialassessment.html'\nimport $ from 'jquery';\nimport windows from 'windows/windows';\nimport _ from 'lodash';\nimport liveapi from 'websockets/binary_websockets';\nimport 'common/util';\nimport 'jquery-growl';\nimport 'css!./financialassessment.css'\n\nlet win = null,\n    win_view = null;\nliveapi.events.on('login', (data) => {\n    const is_mf = /MF/gi.test(local_storage.get('oauth')[0].id);\n\n    // We don't want financial assessment pop-up for mf-clients\n    if (!is_mf) {\n        liveapi.send({ get_account_status: 1 }).then((data) => {\n            const risk = data.get_account_status.risk_classification;\n            if (risk === 'high') {\n                liveapi.send({ get_financial_assessment: 1 }).then((data) => {\n                    if (Object.keys(data.get_financial_assessment).length === 0) {\n                        init();\n                    }\n                });\n            }\n        });\n    }\n});\n\nconst init = () => {\n    if (!win) {\n        win = windows.createBlankWindow($($html).i18n(), {\n            title: \"Financial Assessment\".i18n(),\n            width: 700,\n            height: 500,\n            resizable: false,\n            collapsable: false,\n            minimizable: false,\n            maximizable: false,\n            closable: false,\n            closeOnEscape: false,\n            modal: true,\n            ignoreTileAction: true,\n            'data-authorized': 'true',\n            close: () => {\n                win_view.unbind();\n                win_view = null;\n                win.dialog('destroy');\n                win = null\n            }\n        });\n        const state = {\n            financial: {\n                experience_array: ['0-1 year', '1-2 years', 'Over 3 years'],\n                frequency_array: ['0-5 transactions in the past 12 months', '6-10 transactions in the past 12 months', '40 transactions or more in the past 12 months'],\n\n                forex_trading_experience: '',\n                forex_trading_frequency: '',\n                indices_trading_experience: '',\n                indices_trading_frequency: '',\n                commodities_trading_experience: '',\n                commodities_trading_frequency: '',\n                stocks_trading_experience: '',\n                stocks_trading_frequency: '',\n                other_derivatives_trading_experience: '',\n                other_derivatives_trading_frequency: '',\n                other_instruments_trading_experience: '',\n                other_instruments_trading_frequency: '',\n\n                employment_industry_array: ['Construction', 'Education', 'Finance', 'Health', 'Tourism', 'Other'],\n                employment_industry: '',\n                education_level_array: ['Primary', 'Secondary', 'Tertiary'],\n                education_level: '',\n\n                income_source_array: ['Salaried Employee', 'Self-Employed', 'Investments & Dividends', 'Pension', 'Other'],\n                income_source: '',\n\n                net_income_array: ['Less than $25,000', '$25,000 - $50,000', '$50,001 - $100,000', '$100,001 - $500,000', 'Over $500,000'],\n                net_income: '',\n\n                estimated_worth_array: ['Less than $100,000', '$100,000 - $250,000', '$250,001 - $500,000', '$500,001 - $1,000,000', 'Over $1,000,000'],\n                estimated_worth: '',\n\n                occupation_array: [\"Chief Executives, Senior Officials and Legislators\", \"Managers\", \"Professionals\", \"Clerks\",\n                    \"Personal Care, Sales and Service Workers\", \"Agricultural, Forestry and Fishery Workers\",\n                    \"Craft, Metal, Electrical and Electronics Workers\", \"Plant and Machine Operators and Assemblers\",\n                    \"Mining, Construction, Manufacturing and Transport Workers\", \"Armed Forces\", \"Government Officers\",\n                    \"Others\"\n                ],\n                occupation: '',\n                disabled: false\n            },\n            empty_field: false,\n            validate: () => {\n                return state.financial.forex_trading_experience === '' || state.financial.forex_trading_frequency === '' ||\n                    state.financial.indices_trading_experience === '' || state.financial.indices_trading_frequency === '' ||\n                    state.financial.commodities_trading_experience === '' || state.financial.commodities_trading_frequency === '' ||\n                    state.financial.stocks_trading_experience === '' || state.financial.stocks_trading_frequency === '' ||\n                    state.financial.other_derivatives_trading_experience === '' ||\n                    state.financial.other_derivatives_trading_frequency === '' ||\n                    state.financial.other_instruments_trading_experience === '' ||\n                    state.financial.other_instruments_trading_frequency === '' || state.financial.employment_industry === '' ||\n                    state.financial.occupation === '' || state.financial.education_level === '' ||\n                    state.financial.income_source === '' || state.financial.net_income === '' || state.financial.estimated_worth === '';\n            },\n        };\n        state.submit = () => {\n            state.empty_field = state.validate();\n            if (state.empty_field) {\n                return;\n            }\n            state.financial.disabled = true;\n            const request = {\n                set_financial_assessment: 1,\n                forex_trading_experience: state.financial.forex_trading_experience,\n                forex_trading_frequency: state.financial.forex_trading_frequency,\n                indices_trading_experience: state.financial.indices_trading_experience,\n                indices_trading_frequency: state.financial.indices_trading_frequency,\n                commodities_trading_experience: state.financial.commodities_trading_experience,\n                commodities_trading_frequency: state.financial.commodities_trading_frequency,\n                stocks_trading_experience: state.financial.stocks_trading_experience,\n                stocks_trading_frequency: state.financial.stocks_trading_frequency,\n                other_derivatives_trading_experience: state.financial.other_derivatives_trading_experience,\n                other_derivatives_trading_frequency: state.financial.other_derivatives_trading_frequency,\n                other_instruments_trading_experience: state.financial.other_instruments_trading_experience,\n                other_instruments_trading_frequency: state.financial.other_instruments_trading_frequency,\n                employment_industry: state.financial.employment_industry,\n                education_level: state.financial.education_level,\n                income_source: state.financial.income_source,\n                net_income: state.financial.net_income,\n                estimated_worth: state.financial.estimated_worth,\n                occupation: state.financial.occupation\n            }\n            liveapi.send(request).then((data) => {\n                win_view.unbind();\n                win_view = null;\n                win.dialog(\"destroy\");\n                win = null\n            }).catch((err) => {\n                console.error(err);\n            })\n        }\n        win_view = rv.bind(win, state);\n        win.dialog(\"open\");\n    } else {\n        win.moveToTop();\n    }\n}\n"]}