{"version":3,"sources":["../../../../src/trade/tradeConf.es6"],"names":["require","barsTable","binders","priority","bind","el","model","chart","Highcharts","Chart","title","credits","enabled","type","renderTo","backgroundColor","width","getAttribute","height","tooltip","formatter","tick","array","x","xAxis","min","max","labels","yAxis","align","gridLineWidth","series","data","marker","plotOptions","scatter","enableMouseTracking","exporting","enableImages","legend","routine","ticks","addPlotLineX","options","addPlotLine","value","id","label","text","color","addPlotLineY","addPoint","index","length","last","quote","plot_x","getPlotX","plot_y","getPlotY","removePlotLine","last_1000_ticks","events","on","epoch","push","shift","register_ticks","state","extra","tick_count","symbol","purchase_epoch","buy","purchase_time","fn","add_tick","findIndex","t","decimal_digits","digits_after_decimal","pip","number","utc","format","symbol_name","toFixed","update_status","update","back","visible","off","proposal_open_contract","forget","contract_id","category","contract_category","entry","expiry","tracking_timeout_set","track_ticks","filter","forEach","setTimeout","contract","entry_tick_time","exit_tick_time","date_expiry","console","log","init","show_callback","hide_callback","root","i18n","getbarrier","barrier","includes","category_display","name","message","longcode","balance_after","buy_price","start_time","transaction_id","payout","currency","potential_profit","potential_profit_text","show_result","spreads","amount_per_point","stop_loss_level","stop_profit_level","average","sum","i","avg","inx","digits_value","status","chart_visible","show_tick_chart","arrow","waiting","won","lost","sell_expired","first_quote","head","last_quote","display","sentiment","css","digits","match","differ","over","under","odd","even","callput","up","down","asian","onclick","e","$target","target","hasClass","addClass","viewTransaction","then","removeClass","view"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAC;;;;AAaDA,WAAQ,CAAC,2BAAD,CAAR;AACA,OAAMC,YAAY,6BAAmBA,SAArC;;AAEA;AACA,yBAAGC,OAAH,CAAW,YAAX,IAA2B;AACxBC,gBAAU,EADc,EACV;AACdC,YAAM,cAASC,EAAT,EAAa;AAChB,aAAMC,QAAQ,KAAKA,KAAnB;AACAD,YAAGE,KAAH,GAAW,IAAIC,WAAWC,KAAf,CAAqB;AAC7BC,mBAAO,EADsB;AAE7BC,qBAAS,EAACC,SAAS,KAAV,EAFoB;AAG7BL,mBAAO;AACJM,qBAAM,MADF;AAEJC,yBAAUT,EAFN;AAGJU,gCAAiB,IAHb,EAGmB;AACvBC,sBAAO,CAACX,GAAGY,YAAH,CAAgB,OAAhB,KAA4B,GAA7B,IAAkC,CAJrC;AAKJC,uBAAQ,CAACb,GAAGY,YAAH,CAAgB,QAAhB,KAA6B,GAA9B,IAAmC;AALvC,aAHsB;AAU7BE,qBAAS;AACNC,0BAAW,qBAAY;AACpB,sBAAMC,OAAOf,MAAMgB,KAAN,CAAY,KAAKC,CAAL,GAAO,CAAnB,CAAb;AACA,yBAAQF,QAAQA,KAAKF,OAAd,IAA0B,KAAjC;AACF;AAJK,aAVoB;AAgB7BK,mBAAO;AACJX,qBAAM,QADF;AAEJY,oBAAK,CAFD;AAGJC,oBAAKrB,GAAGY,YAAH,CAAgB,YAAhB,IAA8B,CAA9B,GAAkC,CAHnC,CAGqC;AAHrC,iBAIJU,QAAQ,EAAEf,SAAS,KAAX;AAJJ,aAhBsB;AAsB7BgB,mBAAO;AACJD,uBAAQ,EAAEE,OAAO,MAAT,EAAiBN,GAAG,CAApB,EADJ;AAEJb,sBAAO,EAFH;AAGJoB,8BAAe;AAHX,aAtBsB;AA2B7BC,oBAAQ,CACL,EAAEC,MAAM,EAAR,EADK;AAEL;;;AAGA;AACGnB,qBAAM,SADT;AAEGoB,uBAAQ,EAAErB,SAAS,KAAX,EAFX;AAGGoB,qBAAM;AAHT,aALK,CA3BqB;AAsC7BE,yBAAa,EAAEC,SAAS,EAAEC,qBAAqB,KAAvB,EAAX,EAtCgB;AAuC7BC,uBAAW,EAACzB,SAAS,KAAV,EAAiB0B,cAAc,KAA/B,EAvCkB;AAwC7BC,oBAAQ,EAAC3B,SAAS,KAAV;AAxCqB,UAArB,CAAX;AA0CF,OA9CuB;AA+CxB4B,eAAS,iBAASnC,EAAT,EAAaoC,KAAb,EAAmB;AACzB,aAAMnC,QAAQ,KAAKA,KAAnB;AACA,aAAMoC,eAAe,SAAfA,YAAe,CAACnC,KAAD,EAAQoC,OAAR,EAAoB;AACtCpC,kBAAMiB,KAAN,CAAY,CAAZ,EAAeoB,WAAf,CAA2B;AACxBC,sBAAOF,QAAQE,KADS;AAExBC,mBAAIH,QAAQG,EAAR,IAAcH,QAAQE,KAFF;AAGxBE,sBAAO,EAACC,MAAML,QAAQI,KAAR,IAAiB,OAAxB,EAHiB;AAIxBE,sBAAON,QAAQM,KAAR,IAAiB,SAJA;AAKxBjC,sBAAO2B,QAAQ3B,KAAR,IAAiB;AALA,aAA3B;AAOF,UARD;;AAUA,aAAMkC,eAAe,SAAfA,YAAe,CAAC3C,KAAD,EAAOoC,OAAP,EAAmB;AACrCpC,kBAAMqB,KAAN,CAAY,CAAZ,EAAegB,WAAf,CAA2B;AACxBE,mBAAIH,QAAQG,EAAR,IAAcH,QAAQI,KADF;AAExBF,sBAAOF,QAAQE,KAFS;AAGxBE,sBAAO,EAACC,MAAML,QAAQI,KAAf,EAAsBlB,OAAO,QAA7B,EAHiB;AAIxBoB,sBAAO,OAJiB;AAKxBjC,sBAAO;AALiB,aAA3B;;AAQA;AACAT,kBAAMwB,MAAN,CAAa,CAAb,EAAgBoB,QAAhB,CAAyB,CAAC,CAAD,EAAIR,QAAQE,KAAR,GAAc,CAAlB,CAAzB;AACF,UAXD;;AAaA,aAAMO,QAAQX,MAAMY,MAApB;AACA,aAAGD,SAAS,CAAZ,EAAe;;AAEf,aAAM/B,OAAO,iBAAEiC,IAAF,CAAOb,KAAP,CAAb;AACApC,YAAGE,KAAH,CAASwB,MAAT,CAAgB,CAAhB,EAAmBoB,QAAnB,CAA4B,CAACC,KAAD,EAAQ/B,KAAKkC,KAAL,GAAW,CAAnB,CAA5B;;AAEA,aAAMC,SAASlD,MAAMmD,QAAN,EAAf,CA/ByB,CA+BQ;AACjCD,mBAAUd,aAAarC,GAAGE,KAAhB,EAAsBiD,MAAtB,CAAV;AACA,aAAME,SAASpD,MAAMqD,QAAN,EAAf,CAjCyB,CAiCQ;AACjCD,mBAAUrD,GAAGE,KAAH,CAASqB,KAAT,CAAe,CAAf,EAAkBgC,cAAlB,CAAiCF,OAAOZ,EAAxC,CAAV;AACAY,mBAAUR,aAAa7C,GAAGE,KAAhB,EAAuBmD,MAAvB,CAAV;AAEF,OApFuB,CAoFtB;AApFsB,IAA3B;;AAuFA,OAAMG,kBAAkB,EAAxB,C,CAA4B;AAC5B,+BAAQC,MAAR,CAAeC,EAAf,CAAkB,MAAlB,EAA0B,UAAC/B,IAAD,EAAU;AACjC,UAAMX,OAAOW,KAAKX,IAAlB;AACAA,WAAKkC,KAAL,IAAc,CAAd;AACAlC,WAAK2C,KAAL,IAAc,CAAd;AACAH,sBAAgBI,IAAhB,CAAqB5C,IAArB;AACA,UAAGwC,gBAAgBR,MAAhB,GAAyB,IAA5B,EACGQ,gBAAgBK,KAAhB;AACL,IAPD;;AASA,OAAMC,iBAAiB,SAAjBA,cAAiB,CAACC,KAAD,EAAQC,KAAR,EAAkB;AACtC,UAAIC,aAAaD,MAAMC,UAAN,GAAmB,CAApC;AAAA,UACGC,SAASF,MAAME,MADlB;AAAA,UAEGC,iBAAiBJ,MAAMK,GAAN,CAAUC,aAAV,GAA0B,CAF9C;AAAA,UAGGC,KAAK,IAHR;;AAKA;AACA,UAAMC,WAAW,SAAXA,QAAW,CAACvD,IAAD,EAAS;AACvB,aAAI,iBAAEwD,SAAF,CAAYT,MAAM3B,KAAN,CAAYnB,KAAxB,EAA+B,UAACwD,CAAD;AAAA,mBAAQA,EAAEd,KAAF,GAAQ,CAAR,KAAc3C,KAAK2C,KAAL,GAAW,CAAjC;AAAA,UAA/B,MAAwE,CAAC,CAAzE,IAA8EM,aAAa,CAA/F,EAAkG;AAC/F,gBAAMS,iBAAiB,6BAAmBC,oBAAnB,CAAwCX,MAAMY,GAA9C,EAAmDV,MAAnD,CAAvB;AACAH,kBAAM3B,KAAN,CAAYnB,KAAZ,CAAkB2C,IAAlB,CAAuB;AACpBV,sBAAOlC,KAAKkC,KADQ;AAEpBS,sBAAO3C,KAAK2C,KAFQ;AAGpBkB,uBAAQd,MAAM3B,KAAN,CAAYnB,KAAZ,CAAkB+B,MAAlB,GAA2B,CAHf;AAIpBlC,wBAAS,iBAAOgE,GAAP,CAAW9D,KAAK2C,KAAL,GAAW,IAAtB,EAA4BoB,MAA5B,CAAmC,uBAAnC,IAA8D,OAA9D,GACTf,MAAMgB,WADG,GACW,GADX,GACiBhE,KAAKkC,KAAL,CAAW+B,OAAX,CAAmBP,cAAnB,CALN;AAMpBA,+BAAiBA;AANG,aAAvB;AAQA,cAAET,UAAF;AACA,gBAAIA,eAAe,CAAnB,EAAsB;AACnBF,qBAAM3B,KAAN,CAAY8C,aAAZ;AACAnB,qBAAMK,GAAN,CAAUe,MAAV;AACA;AACApB,qBAAMqB,IAAN,CAAWC,OAAX,GAAqB,IAArB;AACA;AACA,2CAAQ5B,MAAR,CAAe6B,GAAf,CAAmB,wBAAnB,EAA6ChB,EAA7C;AACA,2CAAQiB,sBAAR,CAA+BC,MAA/B,CAAsCxB,MAAMyB,WAA5C;AACA;AACF;AACD;AACA,gBAAI1B,MAAM3B,KAAN,CAAYsD,QAAZ,CAAqBC,iBAArB,KAA2C,QAA/C,EACG5B,MAAM3B,KAAN,CAAY8C,aAAZ;AACL;AACH,OA1BD;;AA4BA,UAAIU,QAAQ,IAAZ;AAAA,UAAkBC,SAAS,IAA3B;AACA,UAAIC,uBAAuB,KAA3B;AACA,UAAMC,cAAc,SAAdA,WAAc,GAAM;AACvBD,gCAAuB,KAAvB;AACAtC,yBAAgBwC,MAAhB,CACG,UAAChF,IAAD;AAAA,mBAAWA,KAAKkD,MAAL,KAAgBF,MAAME,MAAtB,IAAgClD,KAAK2C,KAAL,GAAW,CAAX,IAAgBiC,KAAhD,IAAyD5E,KAAK2C,KAAL,GAAW,CAAX,IAAgBkC,MAApF;AAAA,UADH,EAEEI,OAFF,CAEU1B,QAFV;AAGA,aAAGN,aAAa,CAAhB,EAAmB;AAChB6B,mCAAuB,IAAvB;AACAI,uBAAWH,WAAX,EAAwB,GAAxB;AACF;AACH,OATD;;AAWAzB,WAAK,4BAAQb,MAAR,CAAeC,EAAf,CAAkB,wBAAlB,EAA4C,UAAC/B,IAAD,EAAU;AACxD,aAAMwE,WAAWxE,KAAK4D,sBAAtB;AACA,aAAGY,SAASV,WAAT,KAAyBzB,MAAMyB,WAAlC,EAA+C;AAC/CG,iBAAQO,SAASC,eAAT,GAA2BD,SAASC,eAAT,GAA2B,CAAtD,GAA0DR,KAAlE;AACA;AACA;AACAC,kBAASM,SAASE,cAAT,GAA0BF,SAASE,cAAT,GAA0B,CAApD,GAAwDF,SAASG,WAAT,GAAuBH,SAASG,WAAT,GAAuB,CAA9C,GAAiDT,MAAlH;AACAU,iBAAQC,GAAR,CAAYL,QAAZ,EAAsBN,MAAtB;AACA,aAAG,CAACC,oBAAD,IAAyBF,KAAzB,IAAkCC,MAArC,EACGE;AACH;AACF,OAXI,CAAL;AAYF,IA5DD;;AA8DA;;;;;;;;;;;;;AAaO,OAAMU,sBAAO,SAAPA,IAAO,CAAC9E,IAAD,EAAOqC,KAAP,EAAc0C,aAAd,EAA6BC,aAA7B,EAA+C;AAChE,UAAMC,OAAO,2CAAQC,IAAR,EAAb;AACA,UAAMzC,MAAMzC,KAAKyC,GAAjB;AACA,UAAMM,iBAAiB,6BAAmBC,oBAAnB,CAAwCX,MAAMY,GAA9C,EAAmDZ,MAAME,MAAzD,CAAvB;AACAF,YAAM8C,UAAN,GAAmB,UAAC9F,IAAD,EAAU;AAC1B,aAAI+F,UAAU/F,KAAKkC,KAAL,GAAW,CAAzB;AACA,aAAGc,MAAM+C,OAAN,IAAiB,CAAC,sBAAE,CAAC,MAAD,EAAQ,MAAR,CAAF,EAAmBC,QAAnB,CAA4BhD,MAAMiD,gBAAN,CAAuBC,IAAnD,CAArB,EAA+E;AAC5EH,uBAAW/C,MAAM+C,OAAN,GAAc,CAAzB;AACF;AACD,gBAAOA,QAAQ9B,OAAR,CAAgBP,cAAhB,CAAP;AACF,OAND;AAOA,UAAMX,QAAQ;AACX1D,gBAAO;AACJsC,kBAAM,wBAAwBkE,IAAxB;AADF,UADI;AAIXzC,cAAK;AACF2C,qBAAS,IADP;AAEFI,qBAAS/C,IAAIgD,QAFX;AAGFC,2BAAejD,IAAIiD,aAHjB;AAIFC,uBAAWlD,IAAIkD,SAJb;AAKFjD,2BAAeD,IAAIC,aALjB;AAMFkD,wBAAYnD,IAAImD,UANd;AAOFC,4BAAgBpD,IAAIoD,cAPlB;AAQFC,oBAAQrD,IAAIqD,MARV;AASFC,sBAAU1D,MAAM0D,QATd;AAUFC,8BAAmBvD,IAAIqD,MAAJ,GAAarD,IAAIkD,SAVlC;AAWFM,mCAAwB,SAASf,IAAT,EAXtB;AAYFgB,yBAAa;AAZX,UAJM;AAkBXC,kBAAS;AACNC,8BAAkB3D,IAAI2D,gBAAJ,IAAwB,GADpC;AAENC,6BAAiB5D,IAAI4D,eAAJ,IAAuB,GAFlC;AAGNC,+BAAmB7D,IAAI6D,iBAAJ,IAAyB;AAHtC,UAlBE;AAuBX7F,gBAAO;AACJnB,mBAAO,EADH;AAEJiH,qBAAS,mBAAM;AACZ,mBAAM9F,QAAQ2B,MAAM3B,KAApB;AACA,mBAAMnB,QAAQmB,MAAMnB,KAApB;AACA,mBAAIkH,MAAM,CAAV;AACA,oBAAI,IAAIC,IAAI,CAAZ,EAAeA,IAAInH,MAAM+B,MAAzB,EAAiC,EAAEoF,CAAnC;AACGD,yBAAOlH,MAAMmH,CAAN,EAASlF,KAAT,GAAe,CAAtB;AADH,gBAEA,IAAMmF,MAAMF,OAAOlH,MAAM+B,MAAN,IAAgB,CAAvB,CAAZ;AACA,sBAAOqF,GAAP;AACF,aAVG;AAWJjF,sBAAU,oBAAM;AACb,mBAAMhB,QAAQ2B,MAAM3B,KAApB;AACA,mBAAMkG,MAAMlG,MAAMnB,KAAN,CAAY+B,MAAxB;AACA,mBAAGsF,QAAQ,CAAX,EAAc,OAAO,EAAC9F,OAAO8F,GAAR,EAAa5F,OAAO,aAAamE,IAAb,EAApB,EAAP;AACd,mBAAGyB,QAAQlG,MAAM6B,UAAjB,EAA6B,OAAO,EAACzB,OAAM8F,GAAP,EAAY5F,OAAO,YAAYmE,IAAZ,EAAnB,EAAP;AAC7B,sBAAO,IAAP;AACF,aAjBG;AAkBJvD,sBAAU,oBAAM;AACb,mBAAMlB,QAAQ2B,MAAM3B,KAApB;AACA,mBAAMkG,MAAMlG,MAAMnB,KAAN,CAAY+B,MAAxB;AACA,mBAAMhC,OAAOoB,MAAMnB,KAAN,CAAYqH,MAAI,CAAhB,CAAb;AACA,mBAAGlG,MAAMsD,QAAN,CAAeC,iBAAf,KAAqC,SAArC,IAAkD2C,QAAQ,CAA7D,EAAgE;AAC7D,sBAAMvB,UAAU/C,MAAM8C,UAAN,CAAiB9F,IAAjB,CAAhB;AACA+C,wBAAMK,GAAN,CAAU2C,OAAV,GAAoBA,OAApB,CAF6D,CAEhC;AAC7B,yBAAO,EAACvE,OAAOuE,UAAQ,CAAhB,EAAmBrE,OAAM,YAAYmE,IAAZ,KAAoBE,OAApB,GAA4B,GAArD,EAA0DtE,IAAI,gBAA9D,EAAP;AACF;;AAED,mBAAGL,MAAMsD,QAAN,CAAeC,iBAAf,KAAqC,OAAxC,EAAiD;AAC9C;AACA,sBAAM0C,MAAMjG,MAAM8F,OAAN,GAAgBjD,OAAhB,CAAwBP,iBAAiB,CAAzC,CAAZ;AACA,yBAAO,EAAClC,OAAO6F,GAAR,EAAa3F,OAAM,YAAYmE,IAAZ,KAAqBwB,GAArB,GAA2B,GAA9C,EAAmD5F,IAAI,gBAAvD,EAAP;AACF;AACD,sBAAO,IAAP;AACF,aAlCG;AAmCJwB,wBAAYD,MAAMC,UAnCd;AAoCJzB,mBAAO,CAACwB,MAAMuE,YAAN,IAAsB,GAAvB,IAA8B,EApCjC,EAoCqC;AACzC7C,sBAAU1B,MAAM0B,QArCZ;AAsCJuB,8BAAkBjD,MAAMiD,gBAtCpB;;AAwCJuB,oBAAQ,SAxCJ,EAwCe;AACnBC,2BAAezE,MAAM0E;AAzCjB,UAvBI;AAkEXC,gBAAO;AACJtD,qBAAS,CAACrB,MAAM0E,eAAP,IAA0B1E,MAAM0B,QAAN,CAAeC,iBAAf,KAAqC;AADpE,UAlEI;AAqEXP,eAAM,EAAEC,SAAS,KAAX,EArEK,EAAd;;AAwEAtB,YAAMK,GAAN,CAAUe,MAAV,GAAmB,YAAM;AACtB,aAAMqD,SAASzE,MAAM3B,KAAN,CAAYoG,MAA3B;AACAzE,eAAM1D,KAAN,CAAYsC,IAAZ,GAAmB,EAAEiG,SAAS,wBAAwB/B,IAAxB,EAAX;AAChBgC,iBAAM,oBAAoBhC,IAApB,EADU;AAEhBiC,kBAAM,qBAAqBjC,IAArB;AAFU,WAGjB2B,MAHiB,CAAnB;AAIA,aAAGA,WAAW,MAAd,EAAsB;AACnBzE,kBAAMK,GAAN,CAAUuD,gBAAV,GAA6B,CAAC5D,MAAMK,GAAN,CAAUkD,SAAxC;AACAvD,kBAAMK,GAAN,CAAUqD,MAAV,GAAmB,CAAnB;AACA1D,kBAAMK,GAAN,CAAUwD,qBAAV,GAAkC,MAAlC;AACF;AACD,aAAGY,WAAW,KAAd,EAAqB;AAClBzE,kBAAMK,GAAN,CAAUiD,aAAV,GAA0BjD,IAAIiD,aAAJ,GAAkB,CAAlB,GAAsBtD,MAAMK,GAAN,CAAUqD,MAAV,GAAiB,CAAjE;AACA,wCAAQsB,YAAR,GAFkB,CAEM;AAC1B;AACDhF,eAAMK,GAAN,CAAUyD,WAAV,GAAwB,IAAxB;AACF,OAhBD;AAiBA9D,YAAM3B,KAAN,CAAY8C,aAAZ,GAA4B,YAAM;AAC/B,aAAMR,iBAAiB,6BAAmBC,oBAAnB,CAAwCX,MAAMY,GAA9C,EAAmDZ,MAAME,MAAzD,CAAvB;;AAEA,aAAM8E,cAAc,iBAAEC,IAAF,CAAOlF,MAAM3B,KAAN,CAAYnB,KAAnB,EAA0BiC,KAA1B,CAAgC+B,OAAhC,CAAwCP,cAAxC,IAA0D,EAA9E;AAAA,aACGwE,aAAa,iBAAEjG,IAAF,CAAOc,MAAM3B,KAAN,CAAYnB,KAAnB,EAA0BiC,KAA1B,CAAgC+B,OAAhC,CAAwCP,cAAxC,IAA0D,EAD1E;AAAA,aAEGqC,UAAU/C,MAAM8C,UAAN,CAAiB,iBAAEmC,IAAF,CAAOlF,MAAM3B,KAAN,CAAYnB,KAAnB,CAAjB,IAA8C,EAF3D;AAAA,aAGGsH,eAAexE,MAAM3B,KAAN,CAAYI,KAAZ,GAAoB,EAHtC;AAAA,aAIG0F,UAAUnE,MAAM3B,KAAN,CAAY8F,OAAZ,GAAsBjD,OAAtB,CAA8B,CAA9B,CAJb;AAKA,aAAMS,WAAW3B,MAAM3B,KAAN,CAAYsD,QAA7B;AAAA,aACGyD,UAAUpF,MAAM3B,KAAN,CAAY6E,gBAAZ,CAA6BmC,SAD1C;AAEA,aAAMC,MAAM;AACTC,oBAAQ;AACLC,sBAAQ,iBAAEtG,IAAF,CAAOiG,UAAP,MAAuBX,YAD1B;AAELiB,uBAAS,iBAAEvG,IAAF,CAAOiG,UAAP,MAAuBX,YAF3B;AAGLkB,qBAAM,iBAAExG,IAAF,CAAOiG,UAAP,IAAmB,CAAnB,GAAuBX,eAAa,CAHrC;AAILmB,sBAAO,iBAAEzG,IAAF,CAAOiG,UAAP,IAAmB,CAAnB,GAAuBX,eAAa,CAJtC;AAKLoB,oBAAM,iBAAE1G,IAAF,CAAOiG,UAAP,IAAmB,CAApB,GAAuB,CAAvB,KAA6B,CAL7B;AAMLU,qBAAO,iBAAE3G,IAAF,CAAOiG,UAAP,IAAmB,CAApB,GAAuB,CAAvB,KAA6B;AAN9B,aADC;AASTW,qBAAS;AACNC,mBAAIZ,aAAW,CAAX,GAAenC,UAAQ,CADrB;AAENgD,qBAAMb,aAAW,CAAX,GAAenC,UAAQ;AAFvB,aATA;AAaTiD,mBAAO;AACJF,mBAAI5B,UAAUgB,aAAW,CADrB;AAEJa,qBAAM7B,UAAUgB,aAAW;AAFvB;AAbE,UAAZ;AAkBA;AACAnF,eAAM3B,KAAN,CAAYoG,MAAZ,GAAqBa,IAAI3D,SAASC,iBAAb,EAAgCwD,OAAhC,IAA2C,KAA3C,GAAmD,MAAxE;AACF,OA9BD;;AAgCApF,YAAMqB,IAAN,CAAW6E,OAAX,GAAqB;AAAA,gBAAMtD,cAAcC,IAAd,CAAN;AAAA,OAArB;AACA7C,YAAM4E,KAAN,CAAYsB,OAAZ,GAAsB,UAACC,CAAD,EAAO;AAC1B,aAAMC,UAAU,sBAAED,EAAEE,MAAJ,CAAhB;AACA,aAAG,CAACD,QAAQE,QAAR,CAAiB,UAAjB,CAAJ,EAAkC;AAC/BF,oBAAQG,QAAR,CAAiB,UAAjB;AACA3K,oBAAQ,CAAC,iCAAD,CAAR,EAA6C,UAAC4K,eAAD,EAAqB;AAC/DA,+BAAgB9D,IAAhB,CAAqBzC,MAAMyB,WAA3B,EAAwCzB,MAAMwD,cAA9C,EACIgD,IADJ,CACS;AAAA,yBAAML,QAAQM,WAAR,CAAoB,UAApB,CAAN;AAAA,gBADT;AAEF,aAHD;AAIF;AACH,OATD;;AAWA,UAAMC,OAAO,sBAAG3K,IAAH,CAAQ6G,KAAK,CAAL,CAAR,EAAiB7C,KAAjB,CAAb;;AAEA,UAAG,CAACA,MAAM4E,KAAN,CAAYtD,OAAhB,EAAyB;AAAEvB,wBAAeC,KAAf,EAAsBC,KAAtB;AAA+B,OAA1D,MACK;AAAED,eAAMqB,IAAN,CAAWC,OAAX,GAAqB,IAArB;AAA4B;;AAEnCqB,oBAAcE,IAAd;AACF,IAtJM;;qBAwJS,EAAEH,UAAF,E","file":"tradeConf.js","sourcesContent":["﻿/*\n * Created by amin on December 4, 2015.\n */\n\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport moment from 'moment';\nimport liveapi from '../websockets/binary_websockets';\nimport rv from '../common/rivetsExtra';\nimport chartingRequestMap from '../charts/chartingRequestMap';\nimport html from 'text!../trade/tradeConf.html';\nimport 'css!../trade/tradeConf.css';\n\nrequire(['websockets/stream_handler']);\nconst barsTable = chartingRequestMap.barsTable;\n\n/* rv binder to show tick chart for this confirmation dialog */\nrv.binders['tick-chart'] = {\n   priority: 65, /* a low priority to apply last */\n   bind: function(el) {\n      const model = this.model;\n      el.chart = new Highcharts.Chart({\n         title: '',\n         credits: {enabled: false},\n         chart: {\n            type: 'line',\n            renderTo: el,\n            backgroundColor: null, /* make background transparent */\n            width: (el.getAttribute('width') || 350)*1,\n            height: (el.getAttribute('height') || 120)*1,\n         },\n         tooltip: {\n            formatter: function () {\n               const tick = model.array[this.x-1];\n               return (tick && tick.tooltip) || false;\n            }\n         },\n         xAxis: {\n            type: 'linear',\n            min: 1,\n            max: el.getAttribute('tick-count')*1 + 1 /* exist spot vertical plot will not be at the end */,\n            labels: { enabled: false, }\n         },\n         yAxis: {\n            labels: { align: 'left', x: 0, },\n            title: '',\n            gridLineWidth: 0,\n         },\n         series: [\n            { data: [] },\n            /* HighChart scales the y-axis automatically based on the maximum value of data.\n             * but it doesn't consider the plotLine's value in its calculations.\n             * We add an invisible seri and late plotline values to work around this issue. */\n            {\n               type: 'scatter',\n               marker: { enabled: false },\n               data: []\n            }\n         ],\n         plotOptions: { scatter: { enableMouseTracking: false } },\n         exporting: {enabled: false, enableImages: false},\n         legend: {enabled: false},\n      });\n   }, \n   routine: function(el, ticks){\n      const model = this.model;\n      const addPlotLineX = (chart, options) => {\n         chart.xAxis[0].addPlotLine({\n            value: options.value,\n            id: options.id || options.value,\n            label: {text: options.label || 'label'},\n            color: options.color || '#e98024',\n            width: options.width || 2,\n         });\n      };\n\n      const addPlotLineY = (chart,options) => {\n         chart.yAxis[0].addPlotLine({\n            id: options.id || options.label,\n            value: options.value,\n            label: {text: options.label, align: 'center'},\n            color: 'green',\n            width: 2,\n         });\n\n         /* Add plotline value to invisible seri to make the plotline always visible. */\n         chart.series[1].addPoint([1, options.value*1]);\n      };\n\n      const index = ticks.length;\n      if(index == 0) return;\n\n      const tick = _.last(ticks);\n      el.chart.series[0].addPoint([index, tick.quote*1]);\n\n      const plot_x = model.getPlotX(); // could return null\n      plot_x && addPlotLineX(el.chart,plot_x);\n      const plot_y = model.getPlotY(); // could return null\n      plot_y && el.chart.yAxis[0].removePlotLine(plot_y.id);\n      plot_y && addPlotLineY(el.chart, plot_y);\n\n   } /* end of routine() */\n};\n\nconst last_1000_ticks = []; /* record the last 1k ticks returned */\nliveapi.events.on('tick', (data) => {\n   const tick = data.tick;\n   tick.quote *= 1;\n   tick.epoch *= 1;\n   last_1000_ticks.push(tick);\n   if(last_1000_ticks.length > 1000)\n      last_1000_ticks.shift();\n});\n\nconst register_ticks = (state, extra) => {\n   let tick_count = extra.tick_count * 1,\n      symbol = extra.symbol,\n      purchase_epoch = state.buy.purchase_time * 1,\n      fn = null;\n\n   /* No need to worry about WS connection getting closed, because the user will be logged out */\n   const add_tick = (tick) =>{\n      if (_.findIndex(state.ticks.array, (t) => (t.epoch*1 === tick.epoch*1)) === -1 && tick_count > 0) {\n         const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, symbol);\n         state.ticks.array.push({\n            quote: tick.quote,\n            epoch: tick.epoch,\n            number: state.ticks.array.length + 1,\n            tooltip: moment.utc(tick.epoch*1000).format(\"dddd, MMM D, HH:mm:ss\") + \"<br/>\" +\n            extra.symbol_name + \" \" + tick.quote.toFixed(decimal_digits),\n            decimal_digits : decimal_digits\n         });\n         --tick_count;\n         if (tick_count === 0) {\n            state.ticks.update_status();\n            state.buy.update();\n            /* show buy-price final and profit & update title */\n            state.back.visible = true;\n            /* show back button */\n            liveapi.events.off('proposal_open_contract', fn);\n            liveapi.proposal_open_contract.forget(extra.contract_id);\n            /* unregister from proposal_open_contract stream */\n         }\n         /* update state for each new tick in Up/Down && Asians contracts */\n         if (state.ticks.category.contract_category !== 'digits')\n            state.ticks.update_status();\n      }\n   }\n\n   let entry = null, expiry = null;\n   let tracking_timeout_set = false;\n   const track_ticks = () => {\n      tracking_timeout_set = false;\n      last_1000_ticks.filter(\n         (tick) => (tick.symbol === extra.symbol && tick.epoch*1 >= entry && tick.epoch*1 <= expiry)\n      ).forEach(add_tick);\n      if(tick_count > 0) {\n         tracking_timeout_set = true;\n         setTimeout(track_ticks, 300);\n      }\n   }\n\n   fn = liveapi.events.on('proposal_open_contract', (data) => {\n      const contract = data.proposal_open_contract;\n      if(contract.contract_id !== extra.contract_id) return;\n      entry = contract.entry_tick_time ? contract.entry_tick_time * 1 : entry;\n      // DONT TRUST BACKEND! I'm really angry right now :/\n      // Try everything before calculating expiry.\n      expiry = contract.exit_tick_time ? contract.exit_tick_time * 1 : contract.date_expiry ? contract.date_expiry * 1: expiry;\n      console.log(contract, expiry);\n      if(!tracking_timeout_set && entry && expiry)\n         track_ticks();\n      return;\n   });\n}\n\n/** @param data\n*  @param extra = {\n*    currency: ,\n*    symbol: \"frxXAUUSD\",\n*    symbol_name: \"Gold/USD\",\n*    category: {},\n*    category_display: ,\n*    duration_unit: ,\n*      pip: \"0.001\",\n*   }\n* @param show_callback\n* @param hide_callback\n**/\nexport const init = (data, extra, show_callback, hide_callback) => {\n   const root = $(html).i18n();\n   const buy = data.buy;\n   const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, extra.symbol);\n   extra.getbarrier = (tick) => {\n      let barrier = tick.quote*1;\n      if(extra.barrier && !_(['rise','fall']).includes(extra.category_display.name)) {\n         barrier += extra.barrier*1;\n      }\n      return barrier.toFixed(decimal_digits);\n   }\n   const state = {\n      title: {\n         text: 'Contract Confirmation'.i18n(),\n      },\n      buy: {\n         barrier: null,\n         message: buy.longcode,\n         balance_after: buy.balance_after,\n         buy_price: buy.buy_price,\n         purchase_time: buy.purchase_time,\n         start_time: buy.start_time,\n         transaction_id: buy.transaction_id,\n         payout: buy.payout,\n         currency: extra.currency,\n         potential_profit : buy.payout - buy.buy_price,\n         potential_profit_text : 'Profit'.i18n(),\n         show_result: false,\n      },\n      spreads: {\n         amount_per_point: buy.amount_per_point || '0',\n         stop_loss_level: buy.stop_loss_level || '0',\n         stop_profit_level: buy.stop_profit_level || '0',\n      },\n      ticks: {\n         array: [],\n         average: () => {\n            const ticks = state.ticks;\n            const array = ticks.array;\n            let sum = 0;\n            for(let i = 0; i < array.length; ++i)\n               sum += array[i].quote*1;\n            const avg = sum / (array.length || 1);\n            return avg;\n         },\n         getPlotX: () => {\n            const ticks = state.ticks;\n            const inx = ticks.array.length;\n            if(inx === 1) return {value: inx, label: 'Entry Spot'.i18n()};\n            if(inx === ticks.tick_count) return {value:inx, label: 'Exit Spot'.i18n()}\n            return null;\n         },\n         getPlotY: () => {\n            const ticks = state.ticks;\n            const inx = ticks.array.length;\n            const tick = ticks.array[inx-1];\n            if(ticks.category.contract_category === 'callput' && inx === 1) {\n               const barrier = extra.getbarrier(tick);\n               state.buy.barrier = barrier; /* update barrier value to show in confirm dialog */\n               return {value: barrier*1, label:'Barrier ('.i18n() +barrier+')', id: 'plot-barrier-y'};\n            }\n\n            if(ticks.category.contract_category === 'asian') {\n               //https://trello.com/c/ticslmb4/518-incorrect-decimal-points-for-asian-average\n               const avg = ticks.average().toFixed(decimal_digits + 1);\n               return {value: avg, label:'Average ('.i18n() + avg + ')', id: 'plot-barrier-y'};\n            }\n            return null;\n         },\n         tick_count: extra.tick_count,\n         value: (extra.digits_value || '0') + '', // last digit value selected by the user\n         category: extra.category,\n         category_display: extra.category_display,\n\n         status: 'waiting', /* could be 'waiting', 'lost' or 'won' */\n         chart_visible: extra.show_tick_chart,\n      },\n      arrow: {\n         visible: !extra.show_tick_chart && extra.category.contract_category !== 'digits',\n      },\n      back: { visible: false }, /* back buttom */\n   };\n\n   state.buy.update = () => {\n      const status = state.ticks.status;\n      state.title.text = { waiting: 'Contract Confirmation'.i18n(),\n         won : 'This contract won'.i18n(),\n         lost: 'This contract lost'.i18n()\n      }[status];\n      if(status === 'lost') {\n         state.buy.potential_profit = -state.buy.buy_price;\n         state.buy.payout = 0;\n         state.buy.potential_profit_text = 'Lost';\n      }\n      if(status === 'won') {\n         state.buy.balance_after = buy.balance_after*1 + state.buy.payout*1;\n         liveapi.sell_expired(); // to update balance immediately\n      }\n      state.buy.show_result = true;\n   }\n   state.ticks.update_status = () => {\n      const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, extra.symbol);\n\n      const first_quote = _.head(state.ticks.array).quote.toFixed(decimal_digits) + '',\n         last_quote = _.last(state.ticks.array).quote.toFixed(decimal_digits) + '',\n         barrier = extra.getbarrier(_.head(state.ticks.array)) + '',\n         digits_value = state.ticks.value + '',\n         average = state.ticks.average().toFixed(5);\n      const category = state.ticks.category,\n         display = state.ticks.category_display.sentiment;\n      const css = {\n         digits: {\n            match:  _.last(last_quote) === digits_value,\n            differ:  _.last(last_quote) !== digits_value,\n            over: _.last(last_quote)*1 > digits_value*1,\n            under: _.last(last_quote)*1 < digits_value*1,\n            odd: (_.last(last_quote)*1)%2 === 1,\n            even: (_.last(last_quote)*1)%2 === 0\n         },\n         callput: {\n            up: last_quote*1 > barrier*1,\n            down: last_quote*1 < barrier*1,\n         },\n         asian: {\n            up: average < last_quote*1,\n            down: average > last_quote*1,\n         }\n      };\n      /* set the css class */\n      state.ticks.status = css[category.contract_category][display] ? 'won' : 'lost';\n   }\n\n   state.back.onclick = () => hide_callback(root);\n   state.arrow.onclick = (e) => {\n      const $target = $(e.target);\n      if(!$target.hasClass('disabled')) {\n         $target.addClass('disabled');\n         require(['viewtransaction/viewTransaction'], (viewTransaction) => {\n            viewTransaction.init(extra.contract_id, extra.transaction_id)\n               .then(() => $target.removeClass('disabled'));\n         });\n      }\n   };\n\n   const view = rv.bind(root[0], state)\n\n   if(!state.arrow.visible) { register_ticks(state, extra); }\n   else { state.back.visible = true; }\n\n   show_callback(root);\n}\n\nexport default  { init }\n"]}